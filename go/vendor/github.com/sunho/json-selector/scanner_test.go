package selector

import (
	"strings"
	"testing"

	"github.com/stretchr/testify/assert"
)

func TestScanner(t *testing.T) {
	a := assert.New(t)
	s := newScanner(strings.NewReader("ab.cd[1]"))
	ss, _ := s.scan()
	a.Equal(ss, tLetter)
	ss, _ = s.scan()
	a.Equal(ss, tLetter)
	ss, _ = s.scan()
	a.Equal(ss, tDot)
	ss, _ = s.scan()
	a.Equal(ss, tLetter)
	ss, _ = s.scan()
	a.Equal(ss, tLetter)
	ss, _ = s.scan()
	a.Equal(ss, tOpen)
	ss, _ = s.scan()
	a.Equal(ss, tNumber)
	ss, _ = s.scan()
	a.Equal(ss, tClose)

	s = newScanner(strings.NewReader(`h\.\..h[1][20][10].h`))
	ss, _ = s.scan()
	a.Equal(ss, tLetter)
	ss, _ = s.scan()
	a.Equal(ss, tBackslash)
	ss, _ = s.scan()
	a.Equal(ss, tDot)
	ss, _ = s.scan()
	a.Equal(ss, tBackslash)
	ss, _ = s.scan()
	a.Equal(ss, tDot)
	ss, _ = s.scan()
	a.Equal(ss, tDot)
	ss, _ = s.scan()
	a.Equal(ss, tLetter)
	ss, _ = s.scan()
	a.Equal(ss, tOpen)
	ss, _ = s.scan()
	a.Equal(ss, tNumber)
	ss, _ = s.scan()
	a.Equal(ss, tClose)
	ss, _ = s.scan()
	a.Equal(ss, tOpen)
	ss, _ = s.scan()
	a.Equal(ss, tNumber)
	ss, _ = s.scan()
	a.Equal(ss, tNumber)
	ss, _ = s.scan()
	a.Equal(ss, tClose)
	ss, _ = s.scan()
	a.Equal(ss, tOpen)
	ss, _ = s.scan()
	a.Equal(ss, tNumber)
	ss, _ = s.scan()
	a.Equal(ss, tNumber)
	ss, _ = s.scan()
	a.Equal(ss, tClose)
	ss, _ = s.scan()
	a.Equal(ss, tDot)
	ss, _ = s.scan()
	a.Equal(ss, tLetter)
	ss, _ = s.scan()
}
